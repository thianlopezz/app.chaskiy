<div class="container-fluid">
  <div class="col-md-12">
    <div *ngIf="accion=='I'" class="add btn-group" role="group" aria-label="b-group">
      <button type="button" class="btn btn-sm btn-outline-primary btn-icon" (click)="setReserva()" [disabled]="reservados.length==0">
        {{reservados.length}}
        <i class="fa fa-calendar-plus-o" aria-hidden="true"></i>
      </button>
      <button [disabled]="reservados.length==0" type="button" class="btn btn-sm btn-outline-danger" (click)="quitRes()">
        <i class="fa fa-times" aria-hidden="true"></i>
      </button>
    </div>
    <div *ngIf="accion=='U'" class="add btn-smbtn-group mr-2" role="group" aria-label="First group">
      <button type="button" class="btn btn-sm btn-outline-primary" (click)="goModi()">
        <i class="fa fa-check" aria-hidden="true"></i>
      </button>
      <button type="button" class="btn btn-sm btn-outline-danger" (click)="quitModi()">
        <i class="fa fa-times" aria-hidden="true"></i>
      </button>
    </div>
  </div>
  <br/>
  <div class="col-md-12">
    <table class="table table-bordered">
      <thead>
        <tr>
          <th rowspan="3"></th>
          <th rowspan="3" class="align-buttom">#</th>
          <th rowspan="3" class="align-buttom">Habitaciones</th>
          <th [attr.colspan]="current.days.length">
            <h3 class="center">{{current.mes}}
              <small>{{current.anio}}</small>
            </h3>
          </th>
          <th rowspan="3"></th>
        </tr>
        <tr>
          <th *ngFor="let dia of current.days">{{getWeekDay(dia.day + 1)}}</th>
        </tr>
        <tr>
          <th *ngFor="let dia of current.days">{{dia.day + 1}}</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngIf="loading_hab">
          <td [attr.colspan]="current.days.length + 4">
            <app-spinner></app-spinner>
          </td>
        </tr>
        <tr *ngIf="!loading_hab && rooms.length==0">
          <td [attr.colspan]="current.days.length + 4" style="text-align:center;">
            <p>No tienes habitaciones registradas aun, registra tus habitaciones
              <a [routerLink]="['/room']">aquí</a>
            </p>
          </td>
        </tr>
        <tr *ngFor="let room of rooms; let i = index">
          <td *ngIf="i==0" [attr.rowspan]="rooms.length" class="_nah0 align-middle" (click)="previous()">
            <i class="fa fa-chevron-left" aria-hidden="true"></i>
          </td>
          <td>{{room.nohabitacion}}</td>
          <td>{{room.habitacion}}</td>
          <td *ngFor="let dia of current.days" (click)="clickDay(room, dia.day + 1)" class="p-0 align-bottom" [ngClass]="isSelected(room, dia.day + 1)">
            <!-- <i class="fa" [ngClass]="getIco(room, current, dia.day + 1)" aria-hidden="true"></i> -->
            <!-- <a *ngIf="isReserved(room, dia.day + 1)" tabindex="0" class="btn btn-xs btn-default rounded-0 w-100 h-100" role="button"  data-toggle="modal" data-target="#reservaModal">
            data-toggle="tooltip" data-html="true" [attr.title]="getToolTip(room, dia.day + 1)"
          </a> -->
            <a *ngIf="getLim('I', room, dia.day + 1)" href="javascript:;" data-toggle="tooltip" [attr.title]="getToolTip('I', room, dia.day + 1)"
              data-container="body">
              <i class="fa fa-sign-in" aria-hidden="true"></i>
            </a>
            <a *ngIf="getLim('O', room, dia.day + 1)" href="javascript:;" data-toggle="tooltip" [attr.title]="getToolTip('O', room, dia.day + 1)"
              data-container="body">
              <i class="fa fa-sign-out" aria-hidden="true"></i>
            </a>
          </td>
          <td *ngIf="i==0" [attr.rowspan]="rooms.length" class="_nah0 align-middle" (click)="next()">
            <i class="fa fa-chevron-right" aria-hidden="true"></i>
          </td>
        </tr>
      </tbody>
    </table>
  </div>
  <!-- MODAL RESERVA -->
  <div *ngIf="model" class="modal fade" data-backdrop="static" data-keyboard="false" id="reservaModal">
    <div class="modal-dialog modal-lg" role="document">
      <div class="modal-content">
        <div class="modal-header">
          <h4 class="modal-title">Reserva &nbsp;
            <small *ngIf="esModi && accion=='I'">
              <div class="custom-control custom-checkbox">
                <input type="checkbox" class="custom-control-input" id="proforma" [(ngModel)]="model.esProforma">
                <label class="custom-control-label" for="proforma">Proforma</label>
              </div>
              <!-- <label class="custom-control custom-checkbox">
                <input type="checkbox" class="custom-control-input" [(ngModel)]="model.esProforma">
                <span class="custom-control-indicator"></span>
                <span class="custom-control-description">Proforma</span>
              </label> -->
            </small>
          </h4>
          <font>{{'Estado: ' + getEstado()}}</font>
        </div>
        <form name="form" class="col-md-12" (ngSubmit)="f.form.valid && guardar(f)" #f="ngForm" [ngClass]="{ 'was-validated': f.submitted }"
          novalidate>
          <div *ngIf="esModi">
            <div class="modal-body">
              <div [hidden]="paso!==1">
                <ul class="nav nav-tabs" id="valorestab" role="tablist">
                  <li class="nav-item">
                    <a class="nav-link active" id="habitaciones-tab" data-toggle="tab" href="#habitaciones" role="tab" aria-controls="habitaciones"
                      aria-expanded="true">Habitaciones</a>
                  </li>
                  <li class="nav-item">
                    <a class="nav-link" id="adicionales-tab" data-toggle="tab" href="#adicionales" role="tab" aria-controls="adicionales">Adicionales</a>
                  </li>
                </ul>
                <div class="tab-content" id="TabContent">
                  <div class="tab-pane fade show active" id="habitaciones" role="tabpanel" aria-labelledby="habitaciones">
                    <br>
                    <div class="scroll-15">
                      <div class="row" *ngFor="let room of model.habitaciones">
                        <div class="col-md-8">
                          <div class="row">
                            <div class="col-md-7">
                              <div class="alert alert-info alert-dismissible show" role="alert">
                                <button *ngIf="auxValor.idhabitacion != room.idhabitacion" type="button" class="close" data-dismiss="alert" aria-label="Close"
                                  (click)="delReserve(room)">
                                  <span aria-hidden="true">&times;</span>
                                </button>
                                <h6 class="alert-heading">{{' ' + room.habitacion}}
                                  <br> {{room.fedesde | date : 'dd/MMM/yyyy'}}{{' - '}}{{room.fehasta | date : 'dd/MMM/yyyy'}}
                                </h6>
                              </div>
                            </div>
                            <div class="col-md-5">
                              <label for="tarifa">Tarifa</label>
                              <select class="form-control" name="tarifa" [(ngModel)]="room.idtarifa" #tarifa="ngModel" (change)="changeTarifa(room)">
                                <optgroup *ngFor="let tipo of tarifas" [label]="tipo.tipotarifa">
                                  <option *ngFor="let tarifa of tipo.tarifas" [value]="tarifa.idtarifa">{{tarifa.tarifa}}</option>
                                </optgroup>
                              </select>
                            </div>
                          </div>
                          <div *ngIf="model.habitaciones" [hidden]="model.habitaciones.length>0" class="help-block form-control-feedback">Seleccione al menos una habitación</div>
                        </div>
                        <div class="col-md-4 mb-auto mt-auto">
                          <p *ngIf="!esTotal">
                            {{room.tarifa | currency:'USD':true}} x&nbsp;{{nightDiff(room.fedesde, room.fehasta)}}&nbsp;noche(s)&nbsp;
                            <strong>= {{room.tarifa * nightDiff(room.fedesde, room.fehasta) | currency:'USD':true}}</strong>
                          </p>
                          <p *ngIf="esTotal">
                            {{nightDiff(room.fedesde, room.fehasta)}}&nbsp;noche(s)&nbsp;
                          </p>
                        </div>
                      </div>
                    </div>
                  </div>
                  <div class="tab-pane fade" id="adicionales" role="tabpanel" aria-labelledby="adicionales">
                    <br>
                    <div class="scroll-15">
                      <div class="form-group">
                        <select id="adicional" name="adicional" multiple="multiple" style="width: 100%">
                          <option *ngFor="let add of adicionales" [value]="add.id">{{add.text}}</option>
                        </select>
                        <!-- <select2 [data]="adicionales" [options]="optionsAdi" [value]="valueAd" (valueChanged)="changedAd($event)" name="adicional"
                          width="100%"></select2> -->
                      </div>
                      <div class="row">
                        <div *ngIf="model.valueAd && model.valueAd.length===0" class="alert alert-warning col-md-12 text-center" role="alert">
                          No existen adicionales asignados a la reserva.
                        </div>
                        <div class="col-md-6" *ngFor="let adi of model.valueAd">
                          <div class="alert alert-info alert-dismissible fade show" role="alert">
                            <div *ngIf="auxValor0.idadicional == adi.idadicional" class="input-group">
                              <input type="text" class="form-control" name="adTarifa" placeholder="{{'Tarifa para ' + adi.adicional}}" [(ngModel)]="adi.tarifa"
                                appMoneda="true" #tarifa0="ngModel" />
                              <div class="input-group-prepend">
                                <span class="input-group-text">X</span>
                              </div>
                              <input type="number" class="form-control" name="adCantidad" placeholder="Cantidad" [(ngModel)]="adi.cantidad" #tarifa0="ngModel"
                              />
                              <div class="input-group-append">
                                <button type="button" class="btn btn-primary" (click)="goModiVal0()">
                                  <i class="fa fa-check" aria-hidden="true"></i>
                                </button>
                              </div>
                              <div class="input-group-append">
                                <button type="button" class="btn btn-danger" (click)="cancelTarifa0(adi)">
                                  <i class="fa fa-times" aria-hidden="true"></i>
                                </button>
                              </div>
                            </div>
                            <div *ngIf="auxValor0.idadicional != adi.idadicional">
                              <h6 class="alert-heading">{{' ' + adi.adicional}}&nbsp;
                                <small *ngIf="!esTotal">
                                  <a href="javascript:;" (click)="modiTarifa0(adi)" style="cursor:pointer">
                                    Tarifa &nbsp;{{adi.tarifa | currency:'USD':true}} x&nbsp;{{adi.cantidad}}&nbsp;
                                  </a>
                                  <strong>= {{adi.tarifa * adi.cantidad | currency:'USD':true}}</strong>
                                </small>
                              </h6>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
                <div class="row">
                  <div class="col-md-8"></div>
                  <div class="col-md-4">
                    <hr class="my-1">
                    <div class="d-flex flex-row-reverse">
                      <div class="p-2">
                        <a *ngIf="!esTotal" href="javascript:;" (click)="goTotal('!total')">
                          <h4 *ngIf="!modiTotal">{{getTotal() | currency:'USD':true}}</h4>
                        </a>
                        <a *ngIf="esTotal" href="javascript:;" (click)="goTotal()">
                          <h4 *ngIf="!modiTotal">{{total0 | currency:'USD':true}}</h4>
                        </a>
                        <div *ngIf="modiTotal" class="input-group">
                          <input type="text" class="form-control" name="total" placeholder="Valor total" [(ngModel)]="total0" appMoneda="true" #total="ngModel"
                          />
                          <span class="input-group-btn">
                            <button type="button" class="btn btn-primary" (click)="goModiTotal0()">
                              <i class="fa fa-check" aria-hidden="true"></i>
                            </button>
                          </span>
                          <span class="input-group-btn">
                            <button type="button" class="btn btn-danger" (click)="cancelTotal0(adi)">
                              <i class="fa fa-times" aria-hidden="true"></i>
                            </button>
                          </span>
                        </div>
                      </div>
                      <div class="p-2">
                        <h4>Total</h4>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
              <div [hidden]="paso!==2">
                <div class="habitaciones">
                  <div class="row">
                    <div class="col-md-6">
                      <div class="form-group">
                        <label for="nopersonas">No. personas</label>
                        <input type="number" class="form-control col-md-8" name="nopersonas" [(ngModel)]="model.nopersonas" #nopersonas="ngModel"
                          required />
                        <div *ngIf="f.submitted && !nopersonas.valid" class="invalid-feedback">El número de personas es requerido</div>
                      </div>
                      <div class="form-group">
                        <label for="aerolinea">Aerolínea</label>
                        <select class="form-control col-md-8" name="aerolinea" [(ngModel)]="model.idaerolinea" #aerolinea="ngModel" required>
                          <option *ngFor="let op of aerolineas" [value]="op.idaerolinea">{{op.aerolinea}}</option>
                        </select>
                        <div *ngIf="f.submitted && !aerolinea.valid" class="invalid-feedback">La aerolínea es requerida</div>
                      </div>
                      <div class="form-group">
                        <label for="fuente">Captado de</label>
                        <select class="form-control col-md-8" name="fuente" [(ngModel)]="model.idfuente" #fuente="ngModel" required>
                          <option *ngFor="let op of fuentes" [value]="op.idfuente">{{op.fuente}}</option>
                        </select>
                        <div *ngIf="f.submitted && !fuente.valid" class="invalid-feedback">La fuente de captación es requerida</div>
                      </div>
                      <div class="form-group">
                        <label for="notas">Notas</label>
                        <textarea class="form-control" id="notas" name="notas" rows="2" [(ngModel)]="model.notas" #notas="ngModel" maxlength="600">{{model.notas}}</textarea>
                      </div>
                    </div>
                    <div class="col-md-6">
                      <div class="form-group">
                        <label for="correo">Correo electrónico</label>
                        <div class="input-group">
                          <input type="email" class="form-control col-md-10" name="correo" [(ngModel)]="model.pass.correo" #correo="ngModel" (blur)="correo.valid && getPasse()"
                            [readonly]="accion=='U'" [email]="true" required/>
                          <img *ngIf="goPass" src="/assets/images/loading.svg" />
                        </div>
                        <div *ngIf="f.submitted && !correo.valid" class="invalid-feedback">Ingrese un electrónico válido</div>
                        <div *ngIf="correo.touched && !correo.valid && !f.submitted">
                          <p class="text-danger">Ingrese un electrónico válido</p>
                        </div>
                        <div *ngIf="esPass==false && correo.touched && correo.valid">
                          <p class="text-warning">Pasajero no registrado</p>
                        </div>
                      </div>
                      <div class="form-group">
                        <label for="pasajero">Nombre</label>
                        <div class="input-group">
                          <input type="text" class="form-control col-md-12" name="pasajero" [(ngModel)]="model.pass.pasajero" #pasajero="ngModel" [readonly]="esPass && !editaPass_"
                            maxlength="100" required />
                          <span class="input-group-btn">
                            <button *ngIf="esPass && !editaPass_ && accion=='I'" class="btn btn-outline-danger" type="button" (click)="editaPass()">
                              <i class="fa fa-pencil" aria-hidden="true"></i>
                            </button>
                            <button *ngIf="esPass && editaPass_" class="btn btn-outline-primary" type="button" (click)="correo.valid && pasajero.valid && noContacto.valid && goEditaPass()">
                              <i class="fa fa-check" aria-hidden="true"></i>
                            </button>
                            <button *ngIf="esPass && editaPass_" class="btn btn-outline-danger" type="button" (click)="cancelEditaPass()">
                              <i class="fa fa-times" aria-hidden="true"></i>
                            </button>
                          </span>
                          <span *ngIf="editedPass && !editaPass_" class="mt-auto mb-auto ml-1">
                            <i class="fa fa-check-circle-o fa-lg" style="color: #28a745;" aria-hidden="true"></i>
                          </span>
                        </div>
                        <div *ngIf="(f.submitted && !pasajero.valid)" class="invalid-feedback">El nombre es requerido</div>
                        <div *ngIf="!f.submitted && !pasajero.valid && pasajero.touched">
                          <p class="text-danger">El nombre es requerido</p>
                        </div>
                      </div>
                      <div class="form-group">
                        <label for="pais">Pais</label>
                        <select id="pais" name="pais" style="width: 100%" [disabled]="esPass && !editaPass_">
                          <option *ngFor="let pais of paises" [value]="pais.id">{{pais.text}}</option>
                        </select>
                        <!-- <select2 [data]="paises" [value]="valuePa" (valueChanged)="changedPa($event)" name="pais" width="100%" [disabled]="esPass && !editaPass_"></select2> -->
                      </div>
                      <div class="form-group">
                        <label for="nocontacto">Número de contacto</label>
                        <input type="text" class="form-control col-md-8" name="nocontacto" [(ngModel)]="model.pass.nocontacto" #nocontacto="ngModel"
                          [readonly]="esPass && !editaPass_" maxlength="15" />
                      </div>
                    </div>
                  </div>
                </div>
                <div class="row">
                  <div class="col-md-6"></div>
                  <div class="col-md-6">
                    <hr class="my-1">
                    <div class="d-flex flex-row-reverse">
                      <div class="p-2">
                        <h4 *ngIf="!esTotal">{{getTotal() | currency:'USD':true}}</h4>
                        <h4 *ngIf="esTotal">{{total0 | currency:'USD':true}}</h4>
                      </div>
                      <div class="p-2">
                        <h4>Total</h4>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
            <div class="modal-footer">
              <img *ngIf="loading" src="/assets/images/loading.svg" />
              <button *ngIf="!loading && paso==1" type="button" class="btn btn-success" (click)="siguiente()">Siguiente</button>
              <button *ngIf="!loading && paso==2" type="button" class="btn btn-success" (click)="atras()">Atrás</button>
              <button *ngIf="!loading && paso==2" type="submit" class="btn btn-primary">Guardar</button>
              <button *ngIf="!loading" type="button" class="btn btn-light" data-dismiss="modal" (click)="quitRes()">Cancelar</button>
            </div>
          </div>
          <div *ngIf="!esModi">
            <div class="modal-body">
              <div [hidden]="paso!==1">
                <ul class="nav nav-tabs" id="valorestab" role="tablist">
                  <li class="nav-item">
                    <a class="nav-link active" id="habitaciones-tab" data-toggle="tab" href="#habitaciones" role="tab" aria-controls="habitaciones"
                      aria-expanded="true">Habitaciones</a>
                  </li>
                  <li class="nav-item">
                    <a class="nav-link" id="adicionales-tab" data-toggle="tab" href="#adicionales" role="tab" aria-controls="adicionales">Adicionales</a>
                  </li>
                </ul>
                <div class="tab-content" id="TabContent">
                  <div class="tab-pane fade show active" id="habitaciones" role="tabpanel" aria-labelledby="habitaciones">
                    <br>
                    <div class="scroll-15">
                      <div class="row" *ngFor="let room of model.habitaciones">
                        <div class="col-md-8">
                          <div class="row">
                            <div class="col-md-7">
                              <div class="alert alert-info alert-dismissible show" role="alert">
                                <h6 class="alert-heading">{{' ' + room.habitacion}}
                                  <br> {{room.fedesde | date : 'dd/MMM/yyyy'}}{{' - '}}{{room.fehasta | date : 'dd/MMM/yyyy'}}
                                </h6>
                              </div>
                            </div>
                            <div class="col-md-5">
                              <label for="tarifa">Tarifa</label>
                              <p name="tarifa">{{room.tarifadet}}</p>
                            </div>
                          </div>
                          <div *ngIf="model.habitaciones" [hidden]="model.habitaciones.length>0" class="help-block form-control-feedback">Seleccione al menos una habitación</div>
                        </div>
                        <div class="col-md-4 mb-auto mt-auto">
                          <p *ngIf="!esTotal">
                            {{room.tarifa | currency:'USD':true}} x&nbsp;{{nightDiff(room.fedesde, room.fehasta)}}&nbsp;noche(s)&nbsp;
                            <strong>= {{room.tarifa * nightDiff(room.fedesde, room.fehasta) | currency:'USD':true}}</strong>
                          </p>
                          <p *ngIf="esTotal">
                            {{nightDiff(room.fedesde, room.fehasta)}}&nbsp;noche(s)&nbsp;
                          </p>
                        </div>
                      </div>
                    </div>
                  </div>
                  <div class="tab-pane fade" id="adicionales" role="tabpanel" aria-labelledby="adicionales">
                    <br>
                    <div class="scroll-15">
                      <div class="row">
                        <div *ngIf="model.valueAd && model.valueAd.length===0" class="alert alert-warning col-md-12 text-center" role="alert">
                          No existen adicionales asignados a la reserva.
                        </div>
                        <div class="col-md-6" *ngFor="let adi of model.valueAd">
                          <div class="alert alert-info alert-dismissible fade show" role="alert">
                            <div *ngIf="auxValor0.idadicional != adi.idadicional">
                              <h6 class="alert-heading">{{' ' + adi.adicional}}&nbsp;
                                <small *ngIf="!esTotal">
                                  Tarifa &nbsp;{{adi.tarifa | currency:'USD':true}} x&nbsp;{{adi.cantidad}}&nbsp;= {{adi.tarifa * adi.cantidad | currency:'USD':true}}
                                </small>
                              </h6>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
                <hr class="my-1">
                <div class="row">
                  <div class="col-md-4">
                    <div class="d-flex flex-row-reverse">
                      <div class="p-2">
                        <h5 *ngIf="!esTotal">{{getTotal() | currency:'USD':true}}</h5>
                        <h5 *ngIf="esTotal">{{total0 | currency:'USD':true}}</h5>
                      </div>
                      <div class="p-2">
                        <h5>Total</h5>
                      </div>
                    </div>
                  </div>
                  <div class="col-md-4">
                    <div *ngIf="model.estado != 'Pr'" class="d-flex flex-row-reverse">
                      <div class="p-2">
                        <a [hidden]="model.estado != 'Co'" href="javascript:;">
                          <h5>{{model.totalpagado | currency:'USD':true}}</h5>
                        </a>
                        <a [hidden]="model.estado == 'Co'" href="javascript:;" (click)="getPagos()" data-dismiss="modal" data-toggle="modal" data-target="#pagosModal">
                          <h5>{{model.totalpagado | currency:'USD':true}}</h5>
                        </a>
                      </div>
                      <div class="p-2">
                        <h5>Pagado</h5>
                      </div>
                    </div>
                  </div>
                  <div class="col-md-4">
                    <div *ngIf="model.estado != 'Pr'" class="d-flex flex-row-reverse">
                      <div class="p-2">
                        <h5 *ngIf="!esTotal">{{getTotal() - model.totalpagado | currency:'USD':true}}</h5>
                        <h5 *ngIf="esTotal">{{total0 - model.totalpagado | currency:'USD':true}}</h5>
                      </div>
                      <div class="p-2">
                        <h5>Por pagar</h5>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
              <div [hidden]="paso!==2">
                <div class="habitaciones">
                  <div class="row">
                    <div class="col-md-6">
                      <div class="form-group">
                        <label for="noPersonas">No. personas</label>
                        <p name="noPersonas" class="text-muted">{{model.nopersonas}}</p>
                      </div>
                      <div class="form-group">
                        <label for="aerolinea">Aerolínea</label>
                        <p name="aerolinea" class="text-muted">{{model.aerolinea}}</p>
                      </div>
                      <div class="form-group">
                        <label for="fuente">Captado de</label>
                        <p name="fuente" class="text-muted">{{model.fuente}}</p>
                      </div>
                      <div class="form-group">
                        <label for="notas">Notas</label>
                        <p name="notas" class="text-muted">{{model.notas}}</p>
                      </div>
                    </div>
                    <div class="col-md-6">
                      <div class="form-group">
                        <label for="correo">Correo electrónico</label>
                        <p name="correo" class="text-muted">
                          <a [href]="'mailto:' + model.pass.correo + '?Subject=Reserva%20' + model.idreserva" target="_top">{{model.pass.correo}}</a>
                        </p>
                      </div>
                      <div class="form-group">
                        <label for="pasajero">Nombre</label>
                        <p name="pasajero" class="text-muted">{{model.pass.pasajero}}</p>
                      </div>
                      <div class="form-group">
                        <label for="pais">Pais</label>
                        <p name="pais" class="text-muted">{{model.pass.pais}}</p>
                      </div>
                      <div class="form-group">
                        <label for="nocontacto">Número de contacto</label>
                        <p name="nocontacto" class="text-muted">{{model.pass.nocontacto}}</p>
                      </div>
                    </div>
                  </div>
                </div>
                <div class="row">
                  <div class="col-md-6"></div>
                  <div class="col-md-6">
                    <hr class="my-1">
                    <div class="d-flex flex-row-reverse">
                      <div class="p-2">
                        <h4 *ngIf="!esTotal">{{getTotal() | currency:'USD':true}}</h4>
                        <h4 *ngIf="esTotal">{{total0 | currency:'USD':true}}</h4>
                      </div>
                      <div class="p-2">
                        <h4>Total</h4>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
            <div [hidden]="true" class="modal-body">
              <div class="row">
                <div class="col-md-6">
                  <div class="form-group">
                    <label for="correo">
                      <strong>Correo electrónico</strong>
                    </label>
                    <p name="correo" class="text-muted">
                      <a [href]="'mailto:' + model.pass.correo + '?Subject=Reserva%20' + model.idreserva" target="_top">{{model.pass.correo}}</a>
                    </p>
                  </div>
                  <div class="form-group">
                    <label for="pasajero">
                      <strong>Nombre</strong>
                    </label>
                    <p name="pasajero" class="text-muted">{{model.pass.pasajero}}</p>
                  </div>
                  <div class="form-group">
                    <label for="pais">
                      <strong>Pais</strong>
                    </label>
                    <p name="pais" class="text-muted">{{model.pass.pais}}</p>
                  </div>
                  <div class="form-group">
                    <label for="nocontacto">
                      <strong>Número de contacto</strong>
                    </label>
                    <p name="nocontacto" class="text-muted">{{model.pass.nocontacto}}</p>
                  </div>
                  <div class="form-group">
                    <label for="noPersonas">
                      <strong>Número de personas</strong>
                    </label>
                    <p name="noPersonas" class="text-muted">{{model.nopersonas}}</p>
                  </div>
                  <div class="form-group">
                    <label for="notas">
                      <strong>Notas</strong>
                    </label>
                    <p name="notas" class="text-muted">{{model.notas}}</p>
                  </div>
                </div>
                <div class="col-md-6">
                  <div class="form-group">
                    <label for="fuente">
                      <strong>Captado de</strong>
                    </label>
                    <p name="fuente" class="text-muted">{{model.fuente}}</p>
                  </div>
                  <div class="form-group">
                    <label for="aerolinea">
                      <strong>Aerolínea</strong>
                    </label>
                    <p name="aerolinea" class="text-muted">{{model.aerolinea}}</p>
                  </div>
                  <div class="form-group">
                    <label for="adicional">
                      <strong>Adicionales</strong>
                    </label>
                    <div class="alert alert-info alert-dismissible fade show" role="alert" *ngFor="let adi of model.valueAd">
                      <h6 class="alert-heading">{{' ' + adi.adicional}}&nbsp;
                        <small>
                          <a href="javascript:;" style="cursor:pointer">
                            Tarifa &nbsp;{{adi.tarifa | currency:'USD':true}} x&nbsp;{{adi.cantidad}}&nbsp;
                          </a>
                          <strong>= {{adi.tarifa * adi.cantidad | currency:'USD':true}}</strong>
                        </small>
                      </h6>
                    </div>
                  </div>
                  <div class="form-group">
                    <label for="habitaciones">
                      <strong>Habitaciones</strong>
                    </label>
                    <div class="alert alert-info alert-dismissible fade show" role="alert" *ngFor="let room of model.habitaciones">
                      <h6 class="alert-heading">{{' ' + room.habitacion}}&nbsp;
                        <small>
                          <a href="javascript:;" style="cursor:pointer">
                            Tarifa &nbsp;{{room.tarifa | currency:'USD':true}} x&nbsp;{{nightDiff(room.fedesde, room.fehasta)}} &nbsp;noche(s) &nbsp;
                          </a>
                          <strong>= {{room.tarifa * nightDiff(room.fedesde, room.fehasta) | currency:'USD':true}}</strong>
                        </small>
                      </h6>
                      <strong>{{room.fedesde | date : 'dd/MMM/yyyy'}}{{' - '}}{{room.fehasta | date : 'dd/MMM/yyyy'}}</strong>
                    </div>
                  </div>
                  <hr class="my-1">
                  <div class="d-flex flex-row-reverse">
                    <div class="p-2">
                      <h4>{{getTotal() | currency:'USD':true}}</h4>
                    </div>
                    <div class="p-2">
                      <h4>Total</h4>
                    </div>
                  </div>
                  <div *ngIf="model.estado != 'Pr'" class="d-flex flex-row-reverse">
                    <div class="p-2">
                      <a [hidden]="model.estado != 'Co'" href="javascript:;">
                        <h5>{{model.totalpagado | currency:'USD':true}}</h5>
                      </a>
                      <a [hidden]="model.estado == 'Co'" href="javascript:;" (click)="getPagos()" data-dismiss="modal" data-toggle="modal" data-target="#pagosModal">
                        <h5>{{model.totalpagado | currency:'USD':true}}</h5>
                      </a>
                    </div>
                    <div class="p-2">
                      <h5>Pagado</h5>
                    </div>
                  </div>
                  <div *ngIf="model.estado == 'Pr'" class="d-flex flex-row-reverse">
                    <div class="p-2">
                      <h5>{{getTotal() - model.totalpagado | currency:'USD':true}}</h5>
                    </div>
                    <div class="p-2">
                      <h5>Saldo</h5>
                    </div>
                  </div>
                </div>
              </div>
            </div>
            <div class="modal-footer">
              <img *ngIf="loading" src="/assets/images/loading.svg" />
              <button *ngIf="!loading && paso==1" type="button" class="btn btn-success" (click)="siguiente()">Siguiente</button>
              <button *ngIf="!loading && paso==2" type="button" class="btn btn-success" (click)="atras()">Atrás</button>
              <div *ngIf="model.estado=='Pr'" [hidden]="loading" class="btn-toolbar" role="toolbar" aria-label="Toolbar with button groups">
                <div class="btn-group mr-2" role="group" aria-label="First group">
                  <button type="button" class="btn btn-primary" title="Confirmar" (click)="check('Re')">
                    <i class="fa fa-calendar-plus-o" aria-hidden="true"></i>
                  </button>
                  <button type="button" class="btn btn-outline-danger" title="Cancelar" (click)="check('Ca')">
                    <i class="fa fa-times" aria-hidden="true"></i>
                  </button>
                </div>
              </div>
              <div *ngIf="accion!='I' && model.estado!='Pr'" [hidden]="loading" class="btn-toolbar" role="toolbar" aria-label="Toolbar with button groups">
                <div class="btn-group mr-2" role="group" aria-label="First group">
                  <button *ngIf="ocultaBtnModi('U')" type="button" class="btn btn-outline-danger" title="Modificar" (click)="setModi()">
                    <i class="fa fa-pencil" aria-hidden="true"></i>
                  </button>
                  <button *ngIf="ocultaBtnModi('Ci')" type="button" class="btn btn-outline-danger" title="Check-in" (click)="model.a_estado = 'Ci'"
                    data-toggle="modal" data-target="#detalleEstadosModal">
                    <i class="fa fa-bed" aria-hidden="true"></i>
                  </button>
                  <button *ngIf="ocultaBtnModi('Co')" type="button" class="btn btn-outline-warnig" title="Check-out" (click)="model.a_estado = 'Co'"
                    data-toggle="modal" data-target="#detalleEstadosModal">
                    <i class="fa fa-external-link-square" aria-hidden="true"></i>
                  </button>
                  <button *ngIf="ocultaBtnModi('D')" type="button" class="btn btn-outline-danger" title="Cancelar" (click)="setCancel()" data-toggle="modal"
                    data-target="#confirmModal">
                    <i class="fa fa-calendar-minus-o" aria-hidden="true"></i>
                  </button>
                </div>
              </div>
              <button *ngIf="!loading" type="button" class="btn btn-light" data-dismiss="modal" (click)="quitRes()">Cerrar</button>
            </div>
          </div>
        </form>
      </div>
    </div>
  </div>
  <app-modal-estados [model]="model"></app-modal-estados>
  <!-- MODAL PAGOS -->
  <div *ngIf="model.pago" style="z-index: 1048;" class="modal fade" data-backdrop="static" data-keyboard="false" id="pagosModal">
    <div class="modal-dialog modal-lg" role="document">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title">Pagos
            <i class="fa fa-money" aria-hidden="true"></i>
          </h5>
          <!-- <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button> -->
        </div>
        <form class="col-md-12">
          <div class="row mt-1">
            <div class="col-md-12">
              <button type="button" class="btn btn-danger rounded-circle border-0 pull-right" (click)="setNuevoPago()" data-toggle="modal"
                data-target="#pagoModal">
                <i class="fa fa-plus" aria-hidden="true"></i>
              </button>
            </div>
          </div>
          <div class="form-group">
            <div class="card-deck mt-2">
              <div class="card text-center">
                <div class="card-header text-info">
                  <h3>Total</h3>
                </div>
                <div class="card-block">
                  <h1 class="card-title">{{model.total | currency:'USD':true}}</h1>
                </div>
              </div>
              <div class="card text-center">
                <div class="card-header text-success">
                  <h3>Pagado</h3>
                </div>
                <div class="card-block">
                  <h1 class="card-title">{{model.totalpagado | currency:'USD':true}}</h1>
                </div>
              </div>
              <div class="card text-center">
                <div class="card-header text-warning">
                  <h3>Saldo</h3>
                </div>
                <div class="card-block">
                  <h1 class="card-title">{{getTotal() - model.totalpagado | currency:'USD':true}}</h1>
                </div>
              </div>
            </div>
          </div>
          <div class="form-group">
            <table class="table table-striped">
              <thead>
                <tr>
                  <th width="20%">Forma de Pago</th>
                  <th width="40%">Generado por</th>
                  <th width="15%">Fecha</th>
                  <th width="15%">Monto</th>
                  <th width="10%">Eliminar</th>
                </tr>
              </thead>
              <tbody>
                <tr *ngIf="pagos.length==0">
                  <td colspan="5" align="center">No se han efectuado pagos</td>
                </tr>
                <tr *ngFor="let pago of pagos">
                  <td width="20%">{{pago.formapago}}</td>
                  <td width="40%">{{pago.usuario}}</td>
                  <td width="15%">{{pago.fecha}}</td>
                  <td width="15%">{{pago.monto | currency:'USD':true}}</td>
                  <td width="10%" class="text-center">
                    <div class="btn-group grid-btn" role="group">
                      <button type="button" (click)="setElimPago(pago)" class="btn btn-sm btn-outline-danger" data-toggle="modal" data-target="#confirmModal">
                        <i class="fa fa-trash" aria-hidden="true"></i>
                      </button>
                    </div>
                  </td>
                </tr>
              </tbody>
            </table>
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-light" data-dismiss="modal" data-toggle="modal" data-target="#reservaModal">Cerrar</button>
            <!-- <button type="button" class="btn btn-light" (click)="cierraPagos()">Cerrar</button> -->
          </div>
        </form>
      </div>
    </div>
  </div>
  <!-- MODAL PAGO -->
  <div *ngIf="model.pago" class="modal fade" id="pagoModal">
    <div class="modal-dialog modal-md" role="document">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title">Registro de pago
            <i class="fa fa-money" aria-hidden="true"></i>
          </h5>
          <button type="button" class="close" data-dismiss="modal" aria-label="Close">
            <span aria-hidden="true">&times;</span>
          </button>
        </div>
        <form name="form" class="col-md-12" (ngSubmit)="f.form.valid && guardarPago(f)" #f="ngForm" [ngClass]="{ 'was-validated': f.submitted }"
          novalidate>
          <div class="form-group">
            <label for="formaPago">Forma de pago</label>
            <select class="form-control col-md-5" name="formaPago" [(ngModel)]="model.pago.idforma" #formaPago="ngModel" required>
              <option *ngFor="let op of formaPagos" [value]="op.idforma">{{op.forma}}</option>
            </select>
            <div *ngIf="f.submitted && !formaPago.valid" class="invalid-feedback">La forma de pago es requerida</div>
          </div>
          <div class="form-group">
            <label for="monto">Monto</label>
            <input type="text" class="form-control  col-md-5" name="monto" [(ngModel)]="model.pago.monto" #monto="ngModel" appMoneda="true"
              required />
            <div *ngIf="f.submitted && !monto.valid" class="invalid-feedback">El monto es requerido</div>
          </div>
          <div class="form-group">
            <label for="notasp">Notas</label>
            <textarea class="form-control" id="notasp" name="notasp" rows="2" [(ngModel)]="model.pago.notas" #notasp="ngModel">{{model.pago.notas}}</textarea>
          </div>
          <div class="modal-footer">
            <img *ngIf="loading" src="/assets/images/loading.svg" />
            <button *ngIf="!loading" type="submit" class="btn btn-primary">Guardar</button>
            <button *ngIf="!loading" type="button" class="btn btn-light" data-dismiss="modal">Cancelar</button>
          </div>
        </form>
      </div>
    </div>
  </div>

</div>
<!-- FIN CONTAINER -->